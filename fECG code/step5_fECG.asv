function Of0 = step5_fECG(x,Om0,fs,fr,gamma,alpha,win_len,win_type,lam_beat,OptimalShrinkageOpt)
lam_curve = 20;
basicTF.hop = 20;
basicTF.fs = 100;
basicTF.fr = fr;
basicTF.feat = 'SST11';
I2_orig = x-Om0;
fbeats = step5_fbeats_extract(I2_orig,fs,f_r,gamma,alpha,win_len,win_type, lam_beat,HR_ma)
XN0 = step3_OS(I2_orig,fbeats, OptimalShrinkageOpt)
Of0 = step4_stitch(XN0,x0,current_beats)